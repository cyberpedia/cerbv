# pgBackRest Configuration for Cerberus PostgreSQL Backup
# RTO: 4 hours, RPO: 15 minutes

[global]
# Process locking
lock-path=/tmp/pgbackrest

# Logging
log-level-console=info
log-level-file=debug
log-path=/var/log/pgbackrest

# Process user
process-user=postgres

# Repository configuration
repo1-path=/var/lib/pgbackrest/repo
repo1-retention-full=4
repo1-retention-diff=7
repo1-retention-archive=30

# Backup settings
backup-standby=y
start-fast=y
stop-auto=y

# Checksum validation
checksum=y

# Compression
compress-type=gz
compress-level=6

# Encryption
# repo1-cipher-pass=/etc/pgbackrest/repo1-cipher.pass
# repo1-cipher-type=aes-256-cbc

# Delta restore
delta=y

# Database connection
db-host=postgres-primary
db-port=5432
db-user=postgres

# Error handling
stop-wait-auto=1800

# Archive settings
archive-async=y
archive-push-queue-max=1GB
archive-get-queue-max=512MB

# Recovery settings
recovery-option=preserve-relations=true

[cerberus]
# Database name
db-name=cerberus

# Paths
pg1-path=/var/lib/postgresql/data
pg1-host-user=postgres

# WAL settings
pg1-archive-timeout=600

# Backup options
backup-info=y
backup-label=y
backup-manifest=y

# Retention
retention-archive=30
retention-full=4
retention-diff=7
